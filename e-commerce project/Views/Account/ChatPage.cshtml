
@{
    ViewData["Title"] = "ChatPage";
}
	<div id="chat_main">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<input v-model="message" />
					<button v-on:click="sendMessage" type="button">Отправить</button>
				</div>
				<div class="col-12" v-for="mess in messages ">
					<h4>{{mess}}</h4>
				</div>
			</div>
		</div>
		
		
	</div>


@section Scripts{ 
	<script src="~/js/signalr.min.js"></script>
	<script type="text/javascript">
		let hubUrl = 'https://localhost:5001/chat';
		const hubConnection = new signalR.HubConnectionBuilder()
            .withUrl(hubUrl)
            .configureLogging(signalR.LogLevel.Information)
			.build();

		hubConnection.on("Send", function (data) {
			vue.messages.push(data);
		});
		hubConnection.on("Notify", function (data) {
			vue.messages.push(data);
		});

		hubConnection.start();

		var vue = new Vue({
			el: '#chat_main',
			data: {
				message: '',
				messages:[]
			},
			methods: {
				sendMessage: function () {
					hubConnection.invoke("Send", this.message);
				}
			}
		});

		

		
		
	</script>
}

